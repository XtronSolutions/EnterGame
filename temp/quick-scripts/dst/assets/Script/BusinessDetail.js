
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/BusinessDetail.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'fb8a5ZUBJFFQJtaaJU+yKsK', 'BusinessDetail');
// Script/BusinessDetail.js

"use strict";

var GamePlayReferenceManager = null;
var BusinessDetail = cc.Class({
  name: "BusinessDetail",
  "extends": cc.Component,
  properties: {
    BusinessName: {
      "default": null,
      type: cc.Label,
      serializable: true
    },
    BusinessType: {
      "default": null,
      type: cc.Label,
      serializable: true
    },
    BusinessModeLabel: {
      "default": null,
      type: cc.Label,
      serializable: true
    },
    BusinessBalance: {
      "default": null,
      type: cc.Label,
      serializable: true
    },
    BusinessLocations: {
      "default": null,
      type: cc.Label,
      serializable: true
    },
    CanSell: {
      "default": false,
      type: cc.Boolean,
      serializable: true
    },
    SellBusinessBtnNode: {
      "default": null,
      type: cc.Node,
      serializable: true
    },
    SellLocationBtnNode: {
      "default": null,
      type: cc.Node,
      serializable: true
    },
    BusinessMode: {
      "default": -1,
      type: cc.Integer,
      serializable: true
    },
    BusinessIndex: {
      "default": -1,
      type: cc.Integer,
      serializable: true
    }
  },
  CheckReferences: function CheckReferences() {
    if (!GamePlayReferenceManager || GamePlayReferenceManager == null) GamePlayReferenceManager = require('GamePlayReferenceManager');
  },
  SetBusinessMode: function SetBusinessMode(_val) {
    this.BusinessMode = _val;
  },
  SetBusinessIndex: function SetBusinessIndex(_val) {
    this.BusinessIndex = _val;
  },
  SetName: function SetName(_name) {
    this.BusinessName.string = _name;
  },
  SetType: function SetType(_type) {
    this.BusinessType.string = _type;
  },
  SetMode: function SetMode(_mode) {
    this.BusinessModeLabel.string = _mode;
  },
  SetBalance: function SetBalance(_balance) {
    this.BusinessBalance.string = _balance;
  },
  SetLocations: function SetLocations(_locations) {
    this.BusinessLocations.string = _locations;
  },
  ToggleSellBusinessButton: function ToggleSellBusinessButton(_state) {
    if (this.CanSell) {
      this.SellBusinessBtnNode.getComponent(cc.Button).interactable = _state;
    }
  },
  ToggleSellLocationButton: function ToggleSellLocationButton(_state) {
    if (this.CanSell) {
      this.SellLocationBtnNode.getComponent(cc.Button).interactable = _state;
    }
  },
  SellLocation: function SellLocation() {
    if (this.BusinessMode == 1) //home based
      {//there is not going to be any location for home based
      } else if (this.BusinessMode == 2) //Brick and mortar
      {
        var _manager = GamePlayReferenceManager.Instance.Get_GameManager();

        var _playerIndex = GamePlayReferenceManager.Instance.Get_GameManager().GetTurnNumber();

        var _tempData = _manager.PlayerGameInfo[_playerIndex];

        if (_tempData.NoOfBusiness[this.BusinessIndex].LocationsName.length > 0) //if selected business has any location at all
          {
            if (_tempData.NoOfBusiness[this.BusinessIndex].LoanTaken) //if there is some loan on selected business
              {
                _tempData.NoOfBusiness[this.BusinessIndex].LocationsName.pop();

                var _amount = 75000 - _tempData.NoOfBusiness[this.BusinessIndex].LoanAmount;

                _tempData.NoOfBusiness[this.BusinessIndex].LoanAmount = 0;
                _tempData.NoOfBusiness[this.BusinessIndex].LoanTaken = false;
                _tempData.Cash += _amount;
                GamePlayReferenceManager.Instance.Get_GameplayUIManager().ShowToast("You have successfully sold one of your location, $" + _amount + " added to your cash after paying loan", 2000);
                setTimeout(function () {
                  GamePlayReferenceManager.Instance.Get_GameplayUIManager().SetBusinessUI_SellBusinessUISetup();
                }, 2050);
              } else {
              _tempData.NoOfBusiness[this.BusinessIndex].LocationsName.pop();

              _tempData.Cash += 75000;
              GamePlayReferenceManager.Instance.Get_GameplayUIManager().ShowToast("You have successfully sold one of your location, $75000 added to your cash", 2000);
              setTimeout(function () {
                GamePlayReferenceManager.Instance.Get_GameplayUIManager().SetBusinessUI_SellBusinessUISetup();
              }, 2050);
            }
          }
      }
  },
  SellBusiness: function SellBusiness() {
    var _manager = GamePlayReferenceManager.Instance.Get_GameManager();

    var _playerIndex = GamePlayReferenceManager.Instance.Get_GameManager().GetTurnNumber();

    var _tempData = _manager.PlayerGameInfo[_playerIndex];

    if (_tempData.NoOfBusiness.length > 1) {
      if (this.BusinessMode == 1) //home based
        {
          if (_tempData.NoOfBusiness[this.BusinessIndex].LoanTaken) //if there is some loan on selected business
            {
              var HomeBasedAmount = 10000;

              _tempData.NoOfBusiness.splice(this.BusinessIndex, 1);

              var _amount = HomeBasedAmount - _tempData.NoOfBusiness[this.BusinessIndex].LoanAmount;

              var _loanAmount = _tempData.NoOfBusiness[this.BusinessIndex].LoanAmount - HomeBasedAmount;

              if (_loanAmount <= 0) //means payed all loan
                {
                  _tempData.NoOfBusiness[this.BusinessIndex].LoanAmount = 0;
                  _tempData.NoOfBusiness[this.BusinessIndex].LoanTaken = false;
                } else {
                _tempData.NoOfBusiness[this.BusinessIndex].LoanAmount -= HomeBasedAmount;
              }

              if (_amount <= 0) _amount = 0;
              _tempData.Cash += _amount;
              GamePlayReferenceManager.Instance.Get_GameplayUIManager().ShowToast("You have successfully sold your business, $" + _amount + " added to your cash after paying loan", 2000);
              setTimeout(function () {
                GamePlayReferenceManager.Instance.Get_GameplayUIManager().SetBusinessUI_SellBusinessUISetup();
              }, 2050);
            } else {
            var HomeBasedAmount = 10000;

            _tempData.NoOfBusiness.splice(this.BusinessIndex, 1);

            _tempData.Cash += HomeBasedAmount;
            GamePlayReferenceManager.Instance.Get_GameplayUIManager().ShowToast("You have successfully sold your business, $10000 added to your cash", 2000);
            setTimeout(function () {
              GamePlayReferenceManager.Instance.Get_GameplayUIManager().SetBusinessUI_SellBusinessUISetup();
            }, 2050);
          }
        } else if (this.BusinessMode == 2) //brick and mortar
        {
          if (_tempData.NoOfBusiness[this.BusinessIndex].LoanTaken) //if there is some loan on selected business
            {
              var MortarAmount = 75000;
              var _locations = _tempData.NoOfBusiness[this.BusinessIndex].LocationsName.length;
              if (_locations > 0) //if business have location muliplye each location with amount
                MortarAmount += _locations * MortarAmount;

              var _amount = MortarAmount - _tempData.NoOfBusiness[this.BusinessIndex].LoanAmount;

              var _loanAmount = _tempData.NoOfBusiness[this.BusinessIndex].LoanAmount - MortarAmount;

              if (_loanAmount <= 0) //means payed all loan
                {
                  _tempData.NoOfBusiness[this.BusinessIndex].LoanAmount = 0;
                  _tempData.NoOfBusiness[this.BusinessIndex].LoanTaken = false;
                } else {
                _tempData.NoOfBusiness[this.BusinessIndex].LoanAmount -= HomeBasedAmount;
              }

              if (_amount <= 0) _amount = 0;
              _tempData.Cash += _amount;

              _tempData.NoOfBusiness.splice(this.BusinessIndex, 1);

              GamePlayReferenceManager.Instance.Get_GameplayUIManager().ShowToast("You have successfully sold your business along with any locations, $" + _amount + " added to your cash after paying loan", 2000);
              setTimeout(function () {
                GamePlayReferenceManager.Instance.Get_GameplayUIManager().SetBusinessUI_SellBusinessUISetup();
              }, 2050);
            } else {
            var MortarAmount = 75000;
            var _locations = _tempData.NoOfBusiness[this.BusinessIndex].LocationsName.length;
            if (_locations > 0) //if business have location muliplye each location with amount
              MortarAmount += _locations * MortarAmount;

            _tempData.NoOfBusiness.splice(this.BusinessIndex, 1);

            _tempData.Cash += MortarAmount;
            GamePlayReferenceManager.Instance.Get_GameplayUIManager().ShowToast("You have successfully sold your business, $" + MortarAmount + " added to your cash", 2000);
            setTimeout(function () {
              GamePlayReferenceManager.Instance.Get_GameplayUIManager().SetBusinessUI_SellBusinessUISetup();
            }, 2050);
          }
        }
    } else {
      GamePlayReferenceManager.Instance.Get_GameplayUIManager().ShowToast("Cannot sell, you need atleast one business to continue playing game.", 2000);
    }
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0XFxCdXNpbmVzc0RldGFpbC5qcyJdLCJuYW1lcyI6WyJHYW1lUGxheVJlZmVyZW5jZU1hbmFnZXIiLCJCdXNpbmVzc0RldGFpbCIsImNjIiwiQ2xhc3MiLCJuYW1lIiwiQ29tcG9uZW50IiwicHJvcGVydGllcyIsIkJ1c2luZXNzTmFtZSIsInR5cGUiLCJMYWJlbCIsInNlcmlhbGl6YWJsZSIsIkJ1c2luZXNzVHlwZSIsIkJ1c2luZXNzTW9kZUxhYmVsIiwiQnVzaW5lc3NCYWxhbmNlIiwiQnVzaW5lc3NMb2NhdGlvbnMiLCJDYW5TZWxsIiwiQm9vbGVhbiIsIlNlbGxCdXNpbmVzc0J0bk5vZGUiLCJOb2RlIiwiU2VsbExvY2F0aW9uQnRuTm9kZSIsIkJ1c2luZXNzTW9kZSIsIkludGVnZXIiLCJCdXNpbmVzc0luZGV4IiwiQ2hlY2tSZWZlcmVuY2VzIiwicmVxdWlyZSIsIlNldEJ1c2luZXNzTW9kZSIsIl92YWwiLCJTZXRCdXNpbmVzc0luZGV4IiwiU2V0TmFtZSIsIl9uYW1lIiwic3RyaW5nIiwiU2V0VHlwZSIsIl90eXBlIiwiU2V0TW9kZSIsIl9tb2RlIiwiU2V0QmFsYW5jZSIsIl9iYWxhbmNlIiwiU2V0TG9jYXRpb25zIiwiX2xvY2F0aW9ucyIsIlRvZ2dsZVNlbGxCdXNpbmVzc0J1dHRvbiIsIl9zdGF0ZSIsImdldENvbXBvbmVudCIsIkJ1dHRvbiIsImludGVyYWN0YWJsZSIsIlRvZ2dsZVNlbGxMb2NhdGlvbkJ1dHRvbiIsIlNlbGxMb2NhdGlvbiIsIl9tYW5hZ2VyIiwiSW5zdGFuY2UiLCJHZXRfR2FtZU1hbmFnZXIiLCJfcGxheWVySW5kZXgiLCJHZXRUdXJuTnVtYmVyIiwiX3RlbXBEYXRhIiwiUGxheWVyR2FtZUluZm8iLCJOb09mQnVzaW5lc3MiLCJMb2NhdGlvbnNOYW1lIiwibGVuZ3RoIiwiTG9hblRha2VuIiwicG9wIiwiX2Ftb3VudCIsIkxvYW5BbW91bnQiLCJDYXNoIiwiR2V0X0dhbWVwbGF5VUlNYW5hZ2VyIiwiU2hvd1RvYXN0Iiwic2V0VGltZW91dCIsIlNldEJ1c2luZXNzVUlfU2VsbEJ1c2luZXNzVUlTZXR1cCIsIlNlbGxCdXNpbmVzcyIsIkhvbWVCYXNlZEFtb3VudCIsInNwbGljZSIsIl9sb2FuQW1vdW50IiwiTW9ydGFyQW1vdW50Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLHdCQUF3QixHQUFDLElBQTdCO0FBQ0EsSUFBSUMsY0FBYyxHQUFDQyxFQUFFLENBQUNDLEtBQUgsQ0FBUztBQUN4QkMsRUFBQUEsSUFBSSxFQUFDLGdCQURtQjtBQUV4QixhQUFTRixFQUFFLENBQUNHLFNBRlk7QUFJeEJDLEVBQUFBLFVBQVUsRUFBRTtBQUNSQyxJQUFBQSxZQUFZLEVBQUU7QUFDVixpQkFBUyxJQURDO0FBRVZDLE1BQUFBLElBQUksRUFBRU4sRUFBRSxDQUFDTyxLQUZDO0FBR1ZDLE1BQUFBLFlBQVksRUFBRTtBQUhKLEtBRE47QUFPUkMsSUFBQUEsWUFBWSxFQUFFO0FBQ1YsaUJBQVMsSUFEQztBQUVWSCxNQUFBQSxJQUFJLEVBQUVOLEVBQUUsQ0FBQ08sS0FGQztBQUdWQyxNQUFBQSxZQUFZLEVBQUU7QUFISixLQVBOO0FBYVJFLElBQUFBLGlCQUFpQixFQUFFO0FBQ2YsaUJBQVMsSUFETTtBQUVmSixNQUFBQSxJQUFJLEVBQUVOLEVBQUUsQ0FBQ08sS0FGTTtBQUdmQyxNQUFBQSxZQUFZLEVBQUU7QUFIQyxLQWJYO0FBbUJSRyxJQUFBQSxlQUFlLEVBQUU7QUFDYixpQkFBUyxJQURJO0FBRWJMLE1BQUFBLElBQUksRUFBRU4sRUFBRSxDQUFDTyxLQUZJO0FBR2JDLE1BQUFBLFlBQVksRUFBRTtBQUhELEtBbkJUO0FBeUJSSSxJQUFBQSxpQkFBaUIsRUFBRTtBQUNmLGlCQUFTLElBRE07QUFFZk4sTUFBQUEsSUFBSSxFQUFFTixFQUFFLENBQUNPLEtBRk07QUFHZkMsTUFBQUEsWUFBWSxFQUFFO0FBSEMsS0F6Qlg7QUErQlJLLElBQUFBLE9BQU8sRUFBRTtBQUNM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QW9FLGdEQUE4Q08sWUFBOUMsR0FBMkQscUJBQS9ILEVBQXFKLElBQXJKO0FBQ0FOLFlBQUFBLFVBQVUsQ0FBQyxZQUFNO0FBQ2IvRCxjQUFBQSx3QkFBd0IsQ0FBQytDLFFBQXpCLENBQWtDYyxxQkFBbEMsR0FBMERHLGlDQUExRDtBQUNILGFBRlMsRUFFUCxJQUZPLENBQVY7QUFHSDtBQUNKO0FBQ0osS0F6RkcsTUEyRko7QUFDSWhFLE1BQUFBLHdCQUF3QixDQUFDK0MsUUFBekIsQ0FBa0NjLHFCQUFsQyxHQUEwREMsU0FBMUQsQ0FBb0Usc0VBQXBFLEVBQTJJLElBQTNJO0FBQ0g7QUFFQTtBQTdRdUIsQ0FBVCxDQUFuQiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIEdhbWVQbGF5UmVmZXJlbmNlTWFuYWdlcj1udWxsO1xyXG52YXIgQnVzaW5lc3NEZXRhaWw9Y2MuQ2xhc3Moe1xyXG4gICAgbmFtZTpcIkJ1c2luZXNzRGV0YWlsXCIsXHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIEJ1c2luZXNzTmFtZToge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLCAgICAgICAgXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLkxhYmVsLFxyXG4gICAgICAgICAgICBzZXJpYWxpemFibGU6IHRydWUsXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgQnVzaW5lc3NUeXBlOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsICAgICAgICBcclxuICAgICAgICAgICAgdHlwZTogY2MuTGFiZWwsXHJcbiAgICAgICAgICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSxcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBCdXNpbmVzc01vZGVMYWJlbDoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLCAgICAgICAgXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLkxhYmVsLFxyXG4gICAgICAgICAgICBzZXJpYWxpemFibGU6IHRydWUsXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgQnVzaW5lc3NCYWxhbmNlOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsICAgICAgICBcclxuICAgICAgICAgICAgdHlwZTogY2MuTGFiZWwsXHJcbiAgICAgICAgICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSxcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBCdXNpbmVzc0xvY2F0aW9uczoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLCAgICAgICAgXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLkxhYmVsLFxyXG4gICAgICAgICAgICBzZXJpYWxpemFibGU6IHRydWUsXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgQ2FuU2VsbDoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBmYWxzZSwgICAgICAgIFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5Cb29sZWFuLFxyXG4gICAgICAgICAgICBzZXJpYWxpemFibGU6IHRydWUsXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgU2VsbEJ1c2luZXNzQnRuTm9kZToge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLCAgICAgICAgXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLk5vZGUsXHJcbiAgICAgICAgICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSxcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBTZWxsTG9jYXRpb25CdG5Ob2RlOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsICAgICAgICBcclxuICAgICAgICAgICAgdHlwZTogY2MuTm9kZSxcclxuICAgICAgICAgICAgc2VyaWFsaXphYmxlOiB0cnVlLFxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIEJ1c2luZXNzTW9kZToge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiAtMSwgICAgICAgIFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5JbnRlZ2VyLFxyXG4gICAgICAgICAgICBzZXJpYWxpemFibGU6IHRydWUsXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgQnVzaW5lc3NJbmRleDoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiAtMSwgICAgICAgIFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5JbnRlZ2VyLFxyXG4gICAgICAgICAgICBzZXJpYWxpemFibGU6IHRydWUsXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICBDaGVja1JlZmVyZW5jZXMoKVxyXG4gICAgIHtcclxuICAgICAgICBpZighR2FtZVBsYXlSZWZlcmVuY2VNYW5hZ2VyIHx8IEdhbWVQbGF5UmVmZXJlbmNlTWFuYWdlcj09bnVsbClcclxuICAgICAgICBHYW1lUGxheVJlZmVyZW5jZU1hbmFnZXI9cmVxdWlyZSgnR2FtZVBsYXlSZWZlcmVuY2VNYW5hZ2VyJyk7XHJcbiAgICAgfSxcclxuXHJcbiAgICBTZXRCdXNpbmVzc01vZGUoX3ZhbClcclxuICAgIHtcclxuICAgICAgICB0aGlzLkJ1c2luZXNzTW9kZT1fdmFsO1xyXG4gICAgfSxcclxuXHJcbiAgICBTZXRCdXNpbmVzc0luZGV4KF92YWwpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5CdXNpbmVzc0luZGV4PV92YWw7XHJcbiAgICB9LFxyXG5cclxuICAgIFNldE5hbWUoX25hbWUpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5CdXNpbmVzc05hbWUuc3RyaW5nPV9uYW1lO1xyXG4gICAgfSxcclxuXHJcbiAgICBTZXRUeXBlKF90eXBlKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuQnVzaW5lc3NUeXBlLnN0cmluZz1fdHlwZTtcclxuICAgIH0sXHJcblxyXG4gICAgU2V0TW9kZShfbW9kZSlcclxuICAgIHtcclxuICAgICAgICB0aGlzLkJ1c2luZXNzTW9kZUxhYmVsLnN0cmluZz1fbW9kZTtcclxuICAgIH0sXHJcblxyXG4gICAgU2V0QmFsYW5jZShfYmFsYW5jZSlcclxuICAgIHtcclxuICAgICAgICB0aGlzLkJ1c2luZXNzQmFsYW5jZS5zdHJpbmc9X2JhbGFuY2U7XHJcbiAgICB9LFxyXG5cclxuICAgIFNldExvY2F0aW9ucyhfbG9jYXRpb25zKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuQnVzaW5lc3NMb2NhdGlvbnMuc3RyaW5nPV9sb2NhdGlvbnM7XHJcbiAgICB9LFxyXG5cclxuICAgIFRvZ2dsZVNlbGxCdXNpbmVzc0J1dHRvbihfc3RhdGUpXHJcbiAgICB7XHJcbiAgICAgICAgaWYodGhpcy5DYW5TZWxsKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5TZWxsQnVzaW5lc3NCdG5Ob2RlLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZT1fc3RhdGU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgVG9nZ2xlU2VsbExvY2F0aW9uQnV0dG9uKF9zdGF0ZSlcclxuICAgIHtcclxuICAgICAgICBpZih0aGlzLkNhblNlbGwpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLlNlbGxMb2NhdGlvbkJ0bk5vZGUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlPV9zdGF0ZTsgXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBTZWxsTG9jYXRpb24oKVxyXG4gICAge1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmKHRoaXMuQnVzaW5lc3NNb2RlPT0xKSAvL2hvbWUgYmFzZWRcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIC8vdGhlcmUgaXMgbm90IGdvaW5nIHRvIGJlIGFueSBsb2NhdGlvbiBmb3IgaG9tZSBiYXNlZFxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKHRoaXMuQnVzaW5lc3NNb2RlPT0yKSAvL0JyaWNrIGFuZCBtb3J0YXJcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBfbWFuYWdlcj1HYW1lUGxheVJlZmVyZW5jZU1hbmFnZXIuSW5zdGFuY2UuR2V0X0dhbWVNYW5hZ2VyKCk7XHJcbiAgICAgICAgICAgIHZhciBfcGxheWVySW5kZXg9R2FtZVBsYXlSZWZlcmVuY2VNYW5hZ2VyLkluc3RhbmNlLkdldF9HYW1lTWFuYWdlcigpLkdldFR1cm5OdW1iZXIoKTtcclxuICAgICAgICAgICAgdmFyIF90ZW1wRGF0YT1fbWFuYWdlci5QbGF5ZXJHYW1lSW5mb1tfcGxheWVySW5kZXhdO1xyXG5cclxuICAgICAgICAgICAgaWYoX3RlbXBEYXRhLk5vT2ZCdXNpbmVzc1t0aGlzLkJ1c2luZXNzSW5kZXhdLkxvY2F0aW9uc05hbWUubGVuZ3RoPjApIC8vaWYgc2VsZWN0ZWQgYnVzaW5lc3MgaGFzIGFueSBsb2NhdGlvbiBhdCBhbGxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoX3RlbXBEYXRhLk5vT2ZCdXNpbmVzc1t0aGlzLkJ1c2luZXNzSW5kZXhdLkxvYW5UYWtlbikgLy9pZiB0aGVyZSBpcyBzb21lIGxvYW4gb24gc2VsZWN0ZWQgYnVzaW5lc3NcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGVtcERhdGEuTm9PZkJ1c2luZXNzW3RoaXMuQnVzaW5lc3NJbmRleF0uTG9jYXRpb25zTmFtZS5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgX2Ftb3VudD03NTAwMC1fdGVtcERhdGEuTm9PZkJ1c2luZXNzW3RoaXMuQnVzaW5lc3NJbmRleF0uTG9hbkFtb3VudDtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIF90ZW1wRGF0YS5Ob09mQnVzaW5lc3NbdGhpcy5CdXNpbmVzc0luZGV4XS5Mb2FuQW1vdW50PTA7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RlbXBEYXRhLk5vT2ZCdXNpbmVzc1t0aGlzLkJ1c2luZXNzSW5kZXhdLkxvYW5UYWtlbj1mYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgX3RlbXBEYXRhLkNhc2grPV9hbW91bnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgR2FtZVBsYXlSZWZlcmVuY2VNYW5hZ2VyLkluc3RhbmNlLkdldF9HYW1lcGxheVVJTWFuYWdlcigpLlNob3dUb2FzdChcIllvdSBoYXZlIHN1Y2Nlc3NmdWxseSBzb2xkIG9uZSBvZiB5b3VyIGxvY2F0aW9uLCAkXCIrX2Ftb3VudCtcIiBhZGRlZCB0byB5b3VyIGNhc2ggYWZ0ZXIgcGF5aW5nIGxvYW5cIiwyMDAwKTtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgR2FtZVBsYXlSZWZlcmVuY2VNYW5hZ2VyLkluc3RhbmNlLkdldF9HYW1lcGxheVVJTWFuYWdlcigpLlNldEJ1c2luZXNzVUlfU2VsbEJ1c2luZXNzVUlTZXR1cCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIDIwNTApO1xyXG4gICAgICAgICAgICAgICAgfWVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGVtcERhdGEuTm9PZkJ1c2luZXNzW3RoaXMuQnVzaW5lc3NJbmRleF0uTG9jYXRpb25zTmFtZS5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfdGVtcERhdGEuQ2FzaCs9NzUwMDA7XHJcbiAgICAgICAgICAgICAgICAgICAgR2FtZVBsYXlSZWZlcmVuY2VNYW5hZ2VyLkluc3RhbmNlLkdldF9HYW1lcGxheVVJTWFuYWdlcigpLlNob3dUb2FzdChcIllvdSBoYXZlIHN1Y2Nlc3NmdWxseSBzb2xkIG9uZSBvZiB5b3VyIGxvY2F0aW9uLCAkNzUwMDAgYWRkZWQgdG8geW91ciBjYXNoXCIsMjAwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEdhbWVQbGF5UmVmZXJlbmNlTWFuYWdlci5JbnN0YW5jZS5HZXRfR2FtZXBsYXlVSU1hbmFnZXIoKS5TZXRCdXNpbmVzc1VJX1NlbGxCdXNpbmVzc1VJU2V0dXAoKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAyMDUwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9LFxyXG5cclxuICAgIFNlbGxCdXNpbmVzcygpXHJcbiAgICB7XHJcbiAgICAgICAgdmFyIF9tYW5hZ2VyPUdhbWVQbGF5UmVmZXJlbmNlTWFuYWdlci5JbnN0YW5jZS5HZXRfR2FtZU1hbmFnZXIoKTtcclxuICAgICAgICB2YXIgX3BsYXllckluZGV4PUdhbWVQbGF5UmVmZXJlbmNlTWFuYWdlci5JbnN0YW5jZS5HZXRfR2FtZU1hbmFnZXIoKS5HZXRUdXJuTnVtYmVyKCk7XHJcbiAgICAgICAgdmFyIF90ZW1wRGF0YT1fbWFuYWdlci5QbGF5ZXJHYW1lSW5mb1tfcGxheWVySW5kZXhdO1xyXG5cclxuICAgICAgICBpZihfdGVtcERhdGEuTm9PZkJ1c2luZXNzLmxlbmd0aD4xKVxyXG4gICAgICAgIHtcclxuICAgICAgICBpZih0aGlzLkJ1c2luZXNzTW9kZT09MSkgLy9ob21lIGJhc2VkXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihfdGVtcERhdGEuTm9PZkJ1c2luZXNzW3RoaXMuQnVzaW5lc3NJbmRleF0uTG9hblRha2VuKSAvL2lmIHRoZXJlIGlzIHNvbWUgbG9hbiBvbiBzZWxlY3RlZCBidXNpbmVzc1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgSG9tZUJhc2VkQW1vdW50PTEwMDAwO1xyXG4gICAgICAgICAgICAgICAgX3RlbXBEYXRhLk5vT2ZCdXNpbmVzcy5zcGxpY2UodGhpcy5CdXNpbmVzc0luZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgIHZhciBfYW1vdW50PUhvbWVCYXNlZEFtb3VudC1fdGVtcERhdGEuTm9PZkJ1c2luZXNzW3RoaXMuQnVzaW5lc3NJbmRleF0uTG9hbkFtb3VudDtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgX2xvYW5BbW91bnQ9X3RlbXBEYXRhLk5vT2ZCdXNpbmVzc1t0aGlzLkJ1c2luZXNzSW5kZXhdLkxvYW5BbW91bnQtSG9tZUJhc2VkQW1vdW50O1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICBpZihfbG9hbkFtb3VudDw9MCkgLy9tZWFucyBwYXllZCBhbGwgbG9hblxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIF90ZW1wRGF0YS5Ob09mQnVzaW5lc3NbdGhpcy5CdXNpbmVzc0luZGV4XS5Mb2FuQW1vdW50PTA7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RlbXBEYXRhLk5vT2ZCdXNpbmVzc1t0aGlzLkJ1c2luZXNzSW5kZXhdLkxvYW5UYWtlbj1mYWxzZTtcclxuICAgICAgICAgICAgICAgIH1lbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RlbXBEYXRhLk5vT2ZCdXNpbmVzc1t0aGlzLkJ1c2luZXNzSW5kZXhdLkxvYW5BbW91bnQtPUhvbWVCYXNlZEFtb3VudDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZihfYW1vdW50PD0wKVxyXG4gICAgICAgICAgICAgICAgICAgIF9hbW91bnQ9MDtcclxuXHJcbiAgICAgICAgICAgICAgICBfdGVtcERhdGEuQ2FzaCs9X2Ftb3VudDtcclxuICAgICAgICAgICAgICAgIEdhbWVQbGF5UmVmZXJlbmNlTWFuYWdlci5JbnN0YW5jZS5HZXRfR2FtZXBsYXlVSU1hbmFnZXIoKS5TaG93VG9hc3QoXCJZb3UgaGF2ZSBzdWNjZXNzZnVsbHkgc29sZCB5b3VyIGJ1c2luZXNzLCAkXCIrX2Ftb3VudCtcIiBhZGRlZCB0byB5b3VyIGNhc2ggYWZ0ZXIgcGF5aW5nIGxvYW5cIiwyMDAwKTtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIEdhbWVQbGF5UmVmZXJlbmNlTWFuYWdlci5JbnN0YW5jZS5HZXRfR2FtZXBsYXlVSU1hbmFnZXIoKS5TZXRCdXNpbmVzc1VJX1NlbGxCdXNpbmVzc1VJU2V0dXAoKTtcclxuICAgICAgICAgICAgICAgIH0sIDIwNTApO1xyXG4gICAgICAgICAgICB9ZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgSG9tZUJhc2VkQW1vdW50PTEwMDAwO1xyXG4gICAgICAgICAgICAgICAgX3RlbXBEYXRhLk5vT2ZCdXNpbmVzcy5zcGxpY2UodGhpcy5CdXNpbmVzc0luZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgIF90ZW1wRGF0YS5DYXNoKz1Ib21lQmFzZWRBbW91bnQ7XHJcbiAgICAgICAgICAgICAgICBHYW1lUGxheVJlZmVyZW5jZU1hbmFnZXIuSW5zdGFuY2UuR2V0X0dhbWVwbGF5VUlNYW5hZ2VyKCkuU2hvd1RvYXN0KFwiWW91IGhhdmUgc3VjY2Vzc2Z1bGx5IHNvbGQgeW91ciBidXNpbmVzcywgJDEwMDAwIGFkZGVkIHRvIHlvdXIgY2FzaFwiLDIwMDApO1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgR2FtZVBsYXlSZWZlcmVuY2VNYW5hZ2VyLkluc3RhbmNlLkdldF9HYW1lcGxheVVJTWFuYWdlcigpLlNldEJ1c2luZXNzVUlfU2VsbEJ1c2luZXNzVUlTZXR1cCgpO1xyXG4gICAgICAgICAgICAgICAgfSwgMjA1MCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfWVsc2UgaWYodGhpcy5CdXNpbmVzc01vZGU9PTIpIC8vYnJpY2sgYW5kIG1vcnRhclxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoX3RlbXBEYXRhLk5vT2ZCdXNpbmVzc1t0aGlzLkJ1c2luZXNzSW5kZXhdLkxvYW5UYWtlbikgLy9pZiB0aGVyZSBpcyBzb21lIGxvYW4gb24gc2VsZWN0ZWQgYnVzaW5lc3NcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIE1vcnRhckFtb3VudD03NTAwMDtcclxuICAgICAgICAgICAgICAgIHZhciBfbG9jYXRpb25zPV90ZW1wRGF0YS5Ob09mQnVzaW5lc3NbdGhpcy5CdXNpbmVzc0luZGV4XS5Mb2NhdGlvbnNOYW1lLmxlbmd0aDtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihfbG9jYXRpb25zPjApLy9pZiBidXNpbmVzcyBoYXZlIGxvY2F0aW9uIG11bGlwbHllIGVhY2ggbG9jYXRpb24gd2l0aCBhbW91bnRcclxuICAgICAgICAgICAgICAgICAgICBNb3J0YXJBbW91bnQrPShfbG9jYXRpb25zKk1vcnRhckFtb3VudCk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIF9hbW91bnQ9TW9ydGFyQW1vdW50LV90ZW1wRGF0YS5Ob09mQnVzaW5lc3NbdGhpcy5CdXNpbmVzc0luZGV4XS5Mb2FuQW1vdW50O1xyXG4gICAgICAgICAgICAgICAgdmFyIF9sb2FuQW1vdW50PV90ZW1wRGF0YS5Ob09mQnVzaW5lc3NbdGhpcy5CdXNpbmVzc0luZGV4XS5Mb2FuQW1vdW50LU1vcnRhckFtb3VudDtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgaWYoX2xvYW5BbW91bnQ8PTApIC8vbWVhbnMgcGF5ZWQgYWxsIGxvYW5cclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGVtcERhdGEuTm9PZkJ1c2luZXNzW3RoaXMuQnVzaW5lc3NJbmRleF0uTG9hbkFtb3VudD0wO1xyXG4gICAgICAgICAgICAgICAgICAgIF90ZW1wRGF0YS5Ob09mQnVzaW5lc3NbdGhpcy5CdXNpbmVzc0luZGV4XS5Mb2FuVGFrZW49ZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIF90ZW1wRGF0YS5Ob09mQnVzaW5lc3NbdGhpcy5CdXNpbmVzc0luZGV4XS5Mb2FuQW1vdW50LT1Ib21lQmFzZWRBbW91bnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoX2Ftb3VudDw9MClcclxuICAgICAgICAgICAgICAgICAgICBfYW1vdW50PTA7XHJcblxyXG4gICAgICAgICAgICAgICAgX3RlbXBEYXRhLkNhc2grPV9hbW91bnQ7XHJcbiAgICAgICAgICAgICAgICBfdGVtcERhdGEuTm9PZkJ1c2luZXNzLnNwbGljZSh0aGlzLkJ1c2luZXNzSW5kZXgsIDEpO1xyXG4gICAgICAgICAgICAgICAgR2FtZVBsYXlSZWZlcmVuY2VNYW5hZ2VyLkluc3RhbmNlLkdldF9HYW1lcGxheVVJTWFuYWdlcigpLlNob3dUb2FzdChcIllvdSBoYXZlIHN1Y2Nlc3NmdWxseSBzb2xkIHlvdXIgYnVzaW5lc3MgYWxvbmcgd2l0aCBhbnkgbG9jYXRpb25zLCAkXCIrX2Ftb3VudCtcIiBhZGRlZCB0byB5b3VyIGNhc2ggYWZ0ZXIgcGF5aW5nIGxvYW5cIiwyMDAwKTtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIEdhbWVQbGF5UmVmZXJlbmNlTWFuYWdlci5JbnN0YW5jZS5HZXRfR2FtZXBsYXlVSU1hbmFnZXIoKS5TZXRCdXNpbmVzc1VJX1NlbGxCdXNpbmVzc1VJU2V0dXAoKTtcclxuICAgICAgICAgICAgICAgIH0sIDIwNTApO1xyXG4gICAgICAgICAgICB9ZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgTW9ydGFyQW1vdW50PTc1MDAwO1xyXG4gICAgICAgICAgICAgICAgdmFyIF9sb2NhdGlvbnM9X3RlbXBEYXRhLk5vT2ZCdXNpbmVzc1t0aGlzLkJ1c2luZXNzSW5kZXhdLkxvY2F0aW9uc05hbWUubGVuZ3RoO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKF9sb2NhdGlvbnM+MCkvL2lmIGJ1c2luZXNzIGhhdmUgbG9jYXRpb24gbXVsaXBseWUgZWFjaCBsb2NhdGlvbiB3aXRoIGFtb3VudFxyXG4gICAgICAgICAgICAgICAgICAgIE1vcnRhckFtb3VudCs9KF9sb2NhdGlvbnMqTW9ydGFyQW1vdW50KTtcclxuXHJcbiAgICAgICAgICAgICAgICBfdGVtcERhdGEuTm9PZkJ1c2luZXNzLnNwbGljZSh0aGlzLkJ1c2luZXNzSW5kZXgsIDEpO1xyXG4gICAgICAgICAgICAgICAgX3RlbXBEYXRhLkNhc2grPU1vcnRhckFtb3VudDtcclxuICAgICAgICAgICAgICAgIEdhbWVQbGF5UmVmZXJlbmNlTWFuYWdlci5JbnN0YW5jZS5HZXRfR2FtZXBsYXlVSU1hbmFnZXIoKS5TaG93VG9hc3QoXCJZb3UgaGF2ZSBzdWNjZXNzZnVsbHkgc29sZCB5b3VyIGJ1c2luZXNzLCAkXCIrTW9ydGFyQW1vdW50K1wiIGFkZGVkIHRvIHlvdXIgY2FzaFwiLDIwMDApO1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgR2FtZVBsYXlSZWZlcmVuY2VNYW5hZ2VyLkluc3RhbmNlLkdldF9HYW1lcGxheVVJTWFuYWdlcigpLlNldEJ1c2luZXNzVUlfU2VsbEJ1c2luZXNzVUlTZXR1cCgpO1xyXG4gICAgICAgICAgICAgICAgfSwgMjA1MCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlXHJcbiAgICB7XHJcbiAgICAgICAgR2FtZVBsYXlSZWZlcmVuY2VNYW5hZ2VyLkluc3RhbmNlLkdldF9HYW1lcGxheVVJTWFuYWdlcigpLlNob3dUb2FzdChcIkNhbm5vdCBzZWxsLCB5b3UgbmVlZCBhdGxlYXN0IG9uZSBidXNpbmVzcyB0byBjb250aW51ZSBwbGF5aW5nIGdhbWUuXCIsMjAwMCk7XHJcbiAgICB9XHJcblxyXG4gICAgfSxcclxufSk7XHJcbiJdfQ==